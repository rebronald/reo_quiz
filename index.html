<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Māori Vocabulary Quiz — Standalone</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#10b981;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;color:#e6eef6;background:linear-gradient(180deg,#021124 0%, #071226 100%);-webkit-font-smoothing:antialiased}
    .app{max-width:900px;margin:0 auto;padding:18px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:0}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{background:var(--glass);border:1px solid rgba(255,255,255,0.04);color:inherit;padding:10px 12px;border-radius:12px;font-weight:600}
    .modes{display:flex;gap:6px;overflow:auto;padding:12px 0}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:14px;margin-top:14px;box-shadow:0 6px 20px rgba(2,6,23,0.6)}
    .center{display:flex;flex-direction:column;gap:10px;align-items:center}
    .term{font-size:22px;font-weight:700}
    .def{font-size:15px;color:var(--muted)}
    .choices{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:8px}
    .choice{padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);min-height:54px;display:flex;align-items:center;justify-content:center;text-align:center}
    .choice.correct{outline:3px solid rgba(16,185,129,0.18);}
    .choice.wrong{opacity:0.6;}
    footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;gap:12px}
    .small{font-size:13px;color:var(--muted)}
    input[type=text]{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    @media (max-width:600px){.choices{grid-template-columns:1fr}}
    .pill{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px}
    .progress{height:8px;background:rgba(255,255,255,0.04);border-radius:999px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#06b6d4)}
    .download{background:linear-gradient(90deg,#06b6d4,#10b981);color:#042028}
    .topbar{display:flex;gap:8px;align-items:center}
    .mode-active{box-shadow:0 6px 18px rgba(2,6,23,0.7);border:1px solid rgba(255,255,255,0.06)}
    .tiny{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <h1>Māori Vocabulary Trainer</h1>
        <div class="tiny">Phone-friendly — Flashcard, MCQ, Type-in, Match</div>
      </div>
      <div class="controls">
        <button id="download" class="download">Download HTML</button>
        <button id="reset">Reset progress</button>
      </div>
    </header>

    <nav class="modes card" role="navigation">
      <div style="display:flex;gap:8px;align-items:center;">
        <button class="mode pill mode-active" data-mode="flash">Flashcards</button>
        <button class="mode pill" data-mode="mc">Multiple-choice</button>
        <button class="mode pill" data-mode="type">Type-in</button>
        <button class="mode pill" data-mode="match">Match</button>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <div class="tiny">Shuffle: <input type="checkbox" id="shuffle" checked></div>
<!--        <div class="tiny">Show macrons: <input type="checkbox" id="macrons" checked></div>  -->
      </div>
    </nav>

    <main class="card center" id="mainCard">
      <!-- dynamic content -->
    </main>

    <footer>
      <div class="small">Progress: <span id="scoreText">0 / 0</span></div>
      <div style="flex:1;margin:0 12px"><div class="progress"><i id="bar" style="width:0%"></i></div></div>
      <div class="small">Mode accuracy: <span id="accuracy">—</span></div>
    </footer>
  </div>

<script>
// === DATA: terms with short definitions (mostly ≤ 5 words) ===
const DATA = [
  { term: "Hui", def: "meeting" },
  { term: "Marae", def: "meeting area" },
  { term: "Haere mai", def: "welcome" },
  { term: "Nau mai", def: "welcome" },
  { term: "Tangihanga", def: "funeral rites" },
  { term: "Tangi", def: "to mourn" },
  { term: "Karanga", def: "welcome call" },
  { term: "Manuhiri", def: "guests" },
  { term: "Tangata whenua", def: "local people" },
  { term: "Whaikōrero", def: "formal speech" },
  { term: "Kaikōrero", def: "speaker" },
  { term: "Haka", def: "challenge dance/chant" },
  { term: "Waiata", def: "song" },
  { term: "Koha", def: "gift" },
  { term: "Wharenui", def: "meeting house" },
  { term: "Whare whakairo", def: "carved meeting house" },
  { term: "Whare kai", def: "dining hall" },
  { term: "Whare paku", def: "toilet" },
  { term: "Whare horoi", def: "bathroom" },
  { term: "Aroha", def: "love, compassion" },
  { term: "Ihi", def: "authority, power" },
  { term: "Mana", def: "authority, prestige" },
  { term: "Manaakitanga", def: "hospitality" },
  { term: "Mauri", def: "life force" },
  { term: "Noa", def: "non-sacred" },
  { term: "Raupatu", def: "confiscation" },
  { term: "Rohe", def: "territory" },
  { term: "Taihoa", def: "wait, delay" },
  { term: "Tapu", def: "sacred, taboo" },
  { term: "Tiaki", def: "to care for" },
  { term: "Taonga", def: "treasure" },
  { term: "Tino rangatiratanga", def: "sovereignty" },
  { term: "Tūrangawaewae", def: "place to stand" },
  { term: "Wehi", def: "awe" },
  { term: "Whakapapa", def: "genealogy" },
  { term: "Whenua", def: "land" },
  { term: "Ariki", def: "high chief" },
  { term: "Hapū", def: "sub-tribe" },
  { term: "Iwi", def: "tribe" },
  { term: "Kaumātua", def: "elders" },
  { term: "Ngāi Tātou", def: "all of us" },
  { term: "Pākehā", def: "NZ European" },
  { term: "Rangatira", def: "chief" },
  { term: "Tama", def: "son, young man" },
  { term: "Tamāhine", def: "daughter" },
  { term: "Tamaiti", def: "child" },
  { term: "Tamariki", def: "children" },
  { term: "Tāne", def: "man" },
  { term: "Teina / taina", def: "younger sibling" },
  { term: "Tipuna / tupuna", def: "ancestor" },
  { term: "Tuahine", def: "sister (of man)" },
  { term: "Tuakana", def: "older sibling" },
  { term: "Tungāne", def: "brother (of woman)" },
  { term: "Wahine / wāhine", def: "woman / women" },
  { term: "Waka", def: "canoe group" },
  { term: "Whāngai", def: "adopted child" },
  { term: "Whānau", def: "family" },
  { term: "Whanaunga", def: "relatives" },
  { term: "Au", def: "current" },
  { term: "Awa", def: "river" },
  { term: "Iti", def: "small" },
  { term: "Kai (in names)", def: "food place" },
  { term: "Manga", def: "stream" },
  { term: "Mānia", def: "plain" },
  { term: "Maunga", def: "mountain" },
  { term: "Moana", def: "sea" },
  { term: "Motu", def: "island" },
  { term: "Nui", def: "big" },
  { term: "Ō / O", def: "place of / of" },
  { term: "One", def: "sand" },
  { term: "Pae", def: "ridge" },
  { term: "Papa", def: "flat" },
  { term: "Poto", def: "short" },
  { term: "Puke", def: "hill" },
  { term: "Roa", def: "long" },
  { term: "Roto", def: "lake" },
  { term: "Tai", def: "coast, tide" },
  { term: "Wai", def: "water" },
  { term: "Whanga", def: "harbour" },
  { term: "E noho rā", def: "goodbye (leaving)" },
  { term: "Haere rā", def: "goodbye (staying)" },
  { term: "Hei konā rā", def: "goodbye (less formal)" },
  { term: "Kia ora", def: "hello" },
  { term: "Mōrena", def: "morning" },
  { term: "Tēnā koe", def: "greetings (one)" },
  { term: "Tēnā kōrua", def: "greetings (two)" },
  { term: "Tēnā koutou", def: "greetings (many)" },
  { term: "Tēnā tātou katoa", def: "greetings (all)" },
  { term: "Arero", def: "tongue" },
  { term: "Ihu", def: "nose" },
  { term: "Kakī", def: "neck" },
  { term: "Kauae", def: "chin" },
  { term: "Kōpū", def: "womb" },
  { term: "Māhunga", def: "head / hair" },
  { term: "Manawa", def: "heart" },
  { term: "Niho", def: "teeth" },
  { term: "Poho", def: "chest" },
  { term: "Puku", def: "stomach" },
  { term: "Raho", def: "testicles" },
  { term: "Ringa", def: "hand / arm" },
  { term: "Tenetene", def: "vagina" },
  { term: "Toto", def: "blood" },
  { term: "Tou", def: "anus" },
  { term: "Turi", def: "knee" },
  { term: "Tūtae", def: "excrement" },
  { term: "Ū", def: "breast" },
  { term: "Upoko", def: "head" },
  { term: "Ure", def: "penis" },
  { term: "Waewae", def: "leg / foot" }
];

// === App state ===
let state = {
  mode: 'flash',
  index: 0,
  order: [],
  correct: 0,
  total: 0,
  //showMacrons: true,
  direction: 'm2e' // m2e = Māori → English, e2m = English → Māori
};

const el = id => document.getElementById(id);

// initialize
function init(){
  const saved = JSON.parse(localStorage.getItem('maori_quiz_state')||'null');
  if(saved) Object.assign(state,saved);
  //state.showMacrons = (localStorage.getItem('maori_show_macrons')||'1')==='1';
  //document.getElementById('macrons').checked = state.showMacrons;

  buildOrder(document.getElementById('shuffle').checked);
  bindUi();
  render();
  updateScoreUI();
}

function bindUi(){
  document.querySelectorAll('.mode').forEach(b=>b.addEventListener('click',()=>{
    document.querySelectorAll('.mode').forEach(x=>x.classList.remove('mode-active'));
    b.classList.add('mode-active');
    state.mode=b.dataset.mode;
    state.correct=0; state.total=0;
    render(); updateScoreUI(); saveState();
  }));

  document.getElementById('shuffle').addEventListener('change',()=>{
    buildOrder(document.getElementById('shuffle').checked);
    render(); saveState();
  });

  //document.getElementById('macrons').addEventListener('change',(e)=>{
//    state.showMacrons=e.target.checked;
//    localStorage.setItem('maori_show_macrons', e.target.checked? '1':'0');
//    render();
//  });

  // direction toggle button
  const dirBtn = document.createElement('button');
  dirBtn.textContent = 'Switch: Māori → English';
  dirBtn.className = 'pill';
  dirBtn.onclick = ()=>{
    state.direction = state.direction==='m2e'? 'e2m':'m2e';
    dirBtn.textContent = state.direction==='m2e'? 'Switch: Māori → English':'Switch: English → Māori';
    render(); saveState();
  };
  document.querySelector('nav.modes').appendChild(dirBtn);

  document.getElementById('download').addEventListener('click',downloadSelf);
  document.getElementById('reset').addEventListener('click',()=>{
    if(confirm('Clear saved progress?')){
      localStorage.removeItem('maori_quiz_state');
      //localStorage.removeItem('maori_show_macrons');
      state.correct=0; state.total=0;
      buildOrder(true); render(); updateScoreUI();
    }
  });
}

function buildOrder(shuffle=true){
  state.order = DATA.map((_,i)=>i);
  if(shuffle) shuffleArray(state.order);
  state.index = 0;
}

function render(){
  const main = el('mainCard'); main.innerHTML='';
  if(state.mode==='flash') renderFlash(main);
  else if(state.mode==='mc') renderMC(main);
  else if(state.mode==='type') renderType(main);
  else if(state.mode==='match') renderMatch(main);
}

// choose question/answer sides based on direction
function getSides(item){
  if(state.direction==='m2e'){
    return { question: format(item.term), answer: item.def };
  } else {
    return { question: item.def, answer: format(item.term) };
  }
}

// FLASHCARDS
function renderFlash(container){
  const item = DATA[state.order[state.index]];
  const {question,answer} = getSides(item);
  container.innerHTML =
    `<div class="term">${escapeHtml(question)}</div>
     <div class="def" id="flashDef">(tap to reveal answer)</div>
     <div style="display:flex;gap:8px;margin-top:12px;width:100%">
       <button id="reveal">Reveal</button>
       <button id="prev">Prev</button>
       <button id="next">Next</button>
       <button id="markKnown">I know this</button>
     </div>`;
  el('reveal').onclick = ()=>{ el('flashDef').textContent = answer; };
  el('next').onclick = ()=>{ state.index = (state.index+1) % state.order.length; render(); };
  el('prev').onclick = ()=>{ state.index = (state.index-1+state.order.length) % state.order.length; render(); };
  el('markKnown').onclick = ()=>{ state.correct++; state.total++; nextItem(); updateScoreUI(); saveState(); };
}

// MULTIPLE CHOICE
function renderMC(container){
  const item = DATA[state.order[state.index]];
  const {question,answer} = getSides(item);
  const choices = [answer];
  while(choices.length < 4){
    const r = getSides(DATA[Math.floor(Math.random()*DATA.length)]).answer;
    if(!choices.includes(r)) choices.push(r);
  }
  shuffleArray(choices);

  container.innerHTML =
    `<div class="term">${escapeHtml(question)}</div>
     <div class="choices" id="choices"></div>
     <div style="display:flex;gap:8px;margin-top:12px;width:100%">
       <button id="skip">Skip</button>
       <button id="show">Show answer</button>
     </div>`;

  const chEl = el('choices');
  choices.forEach(c=>{
    const d = document.createElement('div'); d.className='choice'; d.textContent = c;
    d.onclick = ()=>selectChoice(d,c,answer);
    chEl.appendChild(d);
  });

  el('skip').onclick = ()=>{ state.total++; nextItem(); updateScoreUI(); saveState(); };
  el('show').onclick = ()=>{ revealAnswerMC(chEl,answer); };
}

function selectChoice(node,choice,correct){
  if(node.classList.contains('disabled')) return;
  state.total++;
  const correctNode = [...node.parentNode.children].find(c=>c.textContent===correct);

  if(choice===correct){
    node.classList.add('correct'); state.correct++;
  } else {
    node.classList.add('wrong');
    if(correctNode) correctNode.classList.add('correct');
    // explicit text feedback
    setTimeout(()=> alert('Incorrect. Correct answer: ' + correct), 40);
  }

  updateScoreUI(); saveState();
  setTimeout(()=> nextItem(), 900);
}

function revealAnswerMC(container,correct){
  [...container.children].forEach(c=>{
    if(c.textContent===correct) c.classList.add('correct');
    else c.classList.add('wrong');
  });
  state.total++; updateScoreUI(); saveState(); setTimeout(()=> nextItem(),900);
}

// TYPE-IN
function renderType(container){
  const item = DATA[state.order[state.index]];
  const {question,answer} = getSides(item);

  container.innerHTML =
    `<div class="term">${escapeHtml(question)}</div>
     <div class="small">Type the answer</div>
     <input type="text" id="typed" placeholder="Type here">
     <div style="display:flex;gap:8px;margin-top:12px;width:100%">
       <button id="submit">Submit</button>
       <button id="showAns">Show</button>
       <button id="nextBtn">Next</button>
     </div>`;

  el('submit').onclick = ()=>{
    const val = el('typed').value.trim().toLowerCase();
    state.total++;
    // simple fuzzy check: check whether user's first word appears in answer
    if(val && answer.toLowerCase().includes(val.split(' ')[0])){
      setTimeout(()=> alert('Correct!'), 40);
      state.correct++;
    } else {
      setTimeout(()=> alert('Incorrect. Correct answer: ' + answer), 40);
    }
    updateScoreUI(); saveState(); nextItem();
  };

  el('showAns').onclick = ()=> alert(answer);
  el('nextBtn').onclick = ()=> { state.total++; nextItem(); updateScoreUI(); saveState(); };
}

// MATCH
function renderMatch(container){
  const item = DATA[state.order[state.index]];
  const {question,answer} = getSides(item);

  const options = shuffleArray(DATA.map(d=>getSides(d).answer)).slice(0,6);
  if(!options.includes(answer)) options[Math.floor(Math.random()*options.length)] = answer;

  container.innerHTML =
    `<div class="term">${escapeHtml(question)}</div>
     <div class="small">Pick the match</div>
     <select id="matchSel">${options.map(o=>`<option>${escapeHtml(o)}</option>`).join('')}</select>
     <div style="display:flex;gap:8px;margin-top:12px;width:100%">
       <button id="check">Check</button>
       <button id="nextm">Next</button>
     </div>`;

  el('check').onclick = ()=>{
    const sel = el('matchSel').value;
    state.total++;
    if(sel===answer){ state.correct++; setTimeout(()=> alert('Correct!'), 40); }
    else { setTimeout(()=> alert('Incorrect. Correct answer: ' + answer), 40); }
    updateScoreUI(); saveState(); nextItem();
  };

  el('nextm').onclick = ()=> { state.total++; nextItem(); updateScoreUI(); saveState(); };
}

// navigation & helpers
function nextItem(){ state.index = (state.index+1) % state.order.length; render(); }

function updateScoreUI(){
  el('scoreText').textContent = `${state.correct} / ${state.total}`;
  const pct = state.total? Math.round(state.correct/state.total*100):0;
  el('accuracy').textContent = state.total? `${pct}%`:'—';
  el('bar').style.width = (state.order.length? Math.round((state.index/state.order.length)*100):0) + '%';
}

function saveState(){ localStorage.setItem('maori_quiz_state', JSON.stringify(state)); }

function downloadSelf(){
  const blob = new Blob([document.documentElement.outerHTML], {type:'text/html'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'maori_vocab_quiz.html'; a.click(); URL.revokeObjectURL(url);
}

function shuffleArray(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

// format: if macrons off, remove macrons (ā->a etc.)
//function format(s){
 // if(state.showMacrons) return s;
//  return //s.replace(/ā/g,'a').replace(/ē/g,'e').replace(/ī/g,'i').replace(/ō/g,'o').replace(/ū/g,'u')
          //.replace(/Ā/g,'A').replace(/Ē/g,'E').replace(/Ī/g,'I').replace(/Ō/g,'O').replace(/Ū/g,'//U');
//}

function format(s){
  return s;  // always keep macrons
}

// simple escape for inserted HTML text (safety + correct display)
function escapeHtml(text){
  return (text+'').replace(/[&<>"']/g, function(m){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]; });
}

init();
</script>
</body>
</html>
